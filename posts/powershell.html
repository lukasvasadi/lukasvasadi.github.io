<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Lukas Vasadi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../styles/styles.css" />
</head>
<body>
    <nav>
        <a href="../index.html" class="code-text">lukasvasadi</a>
        <div id="desktop-menu">
            <a href="../about.html">About</a>
            <a href="../gallery.html">Gallery</a>
            <a href="mailto:lukas.vasadi@gmail.com"><i class="fa fa-envelope"></i></a>
        </div>
        <a href="javascript:void(0);" class="hamburger" onclick="menuDropdown()"><i class="fa fa-bars"></i></a>
    </nav>
    <div id="mobile-menu">
        <a href="../about.html">About</a>
        <a href="../gallery.html">Gallery</a>
        <a href="lukas.vasadi@gmail.com" class="icon"><i class="fa fa-envelope"></i></a>
    </div>
    <main> 
        <h1 class="center extra-padding">Task automation with PowerShell</h1>
        <h4 class="center">Last updated: October 2021</h4>
        <article>
            <div class="toc">
                <div class="fixed">
                    <h2>Contents</h2>
                    <ul>
                        <li><a href="#intro">Introduction</a></li>
                        <li><a href="#basic-utilities">Basic utilities</a></li>
                        <li><a href="#help">Help</a></li>
                        <li><a href="#pipeline">Pipeline</a></li>
                        <li><a href="#objects">Objects</a></li>
                        <li><a href="#best-practices">Best Practices</a></li>
                        <li><a href="#credits">Credits</a></li>
                    </ul>
                </div>
            </div>
            <div class="content powershell">
                <section>
                    <h2 id="intro">Introduction</h2>
                    <p>
                        The PowerShell command line interface was originally intended to port Unix tools to Windows.
                        However, the developers realized that the fundamental architectural differences between Unix
                        (and Unix clones such as Linux) and Windows&#8212;namely, that Windows is an API-based operating
                        system whereas Unix manages its entire framework through text files&#8212;were insurmountable.
                    </p>
                    <p>
                        As a result, the developers created an entirely new command line interface and scripting language
                        that would become the basis of future Windows releases. In 2016, the project was made opensource and
                        Microsoft announced officially-supported versions for MacOS and select Linux distributions.
                    </p>
                    <p>
                        PowerShell is case insensitive and operates with cmdlets that follow a verb-noun syntax. Similar to
                        batch files, cmdlets can be used within scripts, which may be packaged into modules, to automate 
                        more complicated administrative tasks.
                    </p>
                </section>
                <section>
                    <h2 id="basic-utilities">Basic utilities</h2>
                    <div class="grid definitions">
                        <p><span class="snippet">refreshenv</span></p><p>refresh environment variables</p>
                        <p><span class="snippet">cls</span></p><p>clear shell</p>
                    </div>
                    <p>
                        Sometimes it may be useful to write shell comments, e.g., during webinars or broadcasts. Similar to Unix,
                        comments in PowerShell are preceded with <span class="code-snippet">#</span>, however, block comments may
                        be written between the <span class="code-snippet">&lt;#</span> and <span class="code-snippet">#&gt;</span> symbols.
                    </p>
                    <div class="console">
                        <p class="comment"><span>this is a comment</span></p>
                        <p class="comment-block">
                            <span>
                                &lt;# this is a block comment where you can include more detailed information that may span multiple lines #&gt;
                            </span>
                        </p>
                    </div>
                </section>
                <section>
                    <h2 id="help">Help</h2>
                    <p>
                        The developers of PowerShell believed that no user should memorize commands or syntax. As a result,
                        they packaged PowerShell with an updatable, structured help utility that provides the latest information
                        for cmdlets. With an internet connection, update help with the cmdlets below:
                    </p>
                    <div class="console">
                        <p class="command"><span class="cmdlet">Update-Help</span></p>
                        <p class="comment"><span>often recommended to force execution</span></p>
                        <p class="command"><span class="cmdlet">Update-Help</span> -Force</p>
                    </div>
                    <p>
                        To get help on a cmdlet, use the <span class="code-snippet">Get-Help</span> utility followed by the cmdlet under
                        investigation. This will output a shortlist of helpful information and automatically scroll to the bottom.
                    </p>
                    <div class="console">
                        <p class="command"><span class="cmdlet">Get-Help</span> cmdlet</p>
                    </div>
                    <p>
                        Alternatively, the <span class="code-snippet">help</span> and <span class="code-snippet">man</span> commands may
                        be used to display similar, but often more extensive, detailed information, but starting from the top with the option
                        to show more.
                    </p>
                    <p>
                        The <span class="code-snippet">Get-Help</span> utility may also be used to discover cmdlets for particular operations.
                        For example, when trying to find cmdlets that interactive with services, i.e., background processes analogous to daemons,
                        users can execute one of the help utilities along with a combination of keywords and wildcards: 
                    </p>
                    <div class="console">
                        <p class="comment"><span>use the wildcard * symbol to broaden search</span></p>
                        <p class="command"><span class="cmdlet">Get-Help</span> *service*</p>
                        <p class="comment"><span>add a g before the search criteria to produce a shortlist of results</span></p>
                        <p class="command"><span class="cmdlet">Get-Help</span> g*service*</p>
                    </div>
                    <p>
                        This will return a list of potentially relevant cmdlets with "service" as part of their name. To see more extensive 
                        information about a cmdlet, use the <span class="code-snippet">-Detailed</span> parameter. 
                    </p>
                    <div class="console">
                        <p class="comment"><span>retrieve brief information about a cmdlet</span></p>
                        <p class="command"><span class="cmdlet">Get-Help</span> Get-Service</p>
                        <p class="comment"><span>retrieve more detailed information</span></p>
                        <p class="command"><span class="cmdlet">Get-Help</span> Get-Service -Detailed</p>
                        <p class="comment"><span>view examples</span></p>
                        <p class="command"><span class="cmdlet">Get-Help</span> Get-Service -Examples</p>
                        <p class="comment"><span>understand how the cmdlet works in a pipeline</span></p>
                        <p class="command"><span class="cmdlet">Get-Help</span> Get-Service -Full</p>
                        <p class="comment"><span>display help in a popup window</span></p>
                        <p class="command"><span class="cmdlet">Get-Help</span> Get-Service -ShowWindow</p>
                    </div>
                </section>
                <section>
                    <h2 id="pipeline">Pipeline</h2>
                    <p>
                        Similar to other shell scripting tools, the PowerShell pipe (<span class="snippet">|</span>) utility allows users to pass 
                        data output from one command to the input of another.
                    </p>
                    <div class="console">
                        <p class="comment"><span>export a list of current active services to a csv file</span></p>
                        <p class="command"><span class="cmdlet">Get-Service</span> | <span class="cmdlet">Export-csv</span> -Path C:\Users\user\Desktop</p>
                    </div>
                </section>
                <section>
                    <h2 id="objects">Objects</h2>
                    <p>
                        In contrast to Unix-like systems, where all shell interactions are based on text-based input/output, PowerShell was designed to work directly 
                        with objects. In manay cases, this reduces the amount of work necessary to accomplish certain tasks, as there is no overhead management of 
                        filler text output. As an example, if you wanted to restrict <span class="snippet">Get-Process</span> output to handles greater than 900:
                    </p>
                    <div class="console">
                        <p class="command"><span class="cmdlet">Get-Process</span> | <span class="cmdlet">Where</span> Handles -gt 900</p>
                    </div>
                    <p>
                        This one line of code replaces several lines that would be needed to achieve the same result with Bash.
                    </p>
                    <p>
                        Every object has associated properties and methods, which describe features of the object class as well as actionable functions, respectively. 
                        The <span class="snippet">Get-Member</span> utility, with shorthand <span class="snippet">gm</span>, prints all properties and methods of an object 
                        along with its class definition.
                    </p>
                    <div class="console">
                        <p class="comment"><span>find the properties of the bits service object</span></p>
                        <p class="command"><span class="cmdlet">Get-Service</span> -Name bits | <span class="cmdlet">Get-Member</span></p>
                    </div>
                    <p>
                        With this information, you can choose to customize output based on object class properties.
                    </p>
                    <div class="console">
                        <p class="comment"><span>print the name and status of every object returned from get-service</span></p>
                        <p class="command"><span class="cmdlet">Get-Service</span> | <span class="cmdlet">Select-Object</span> -Property Name, Status</p>
                        <p class="comment"><span>print the name and length of each object and sort by length</span></p>
                        <p class="command">
                            <span class="cmdlet">Get-ChildItem</span> | <span class="cmdlet">Select-Object</span> -Property Name, Length | 
                            <span class="cmdlet">Sort</span> -Property Length
                        </p>
                    </div>
                </section>
                <section>
                    <h2 id="best-practices">Best Practices</h2>
                    <p>
                        PowerShell is a powerful tool that can cause major system damage if mishandled. When unsure about the ramifications of a certain 
                        command, administrators can use the <span class="snippet">WhatIf</span> parameter to print out the results of the questionable 
                        command without execution.
                    </p>
                    <div class="console">
                        <p class="comment"><span>the following command would kill all active services and likely damage the system</span></p>
                        <p class="command"><span class="cmdlet">Get-Service</span> | <span class="cmdlet">Stop-Service</span> -WhatIf</p>
                    </div>
                    <p>
                        Administrators may also consider using the <span class="snippet">Confirm</span> parameter to be prompted for confirmation before 
                        command execution.
                    </p>
                    <div class="console">
                        <p class="comment"><span>print out command execution results with confirmation prompt</span></p>
                        <p class="command"><span class="cmdlet">Get-Service</span> | <span class="cmdlet">Stop-Service</span> -Confirm</p>
                    </div>
                </section>
                <section>
                    <h2 id="credits">Credits</h2>
                    <p>
                        The content presented was based on the <a href="https://www.youtube.com/watch?v=UVUd9_k9C6A&t=7637s">PowerShell for Beginners</a> course hosted 
                        by Jeffrey Snover, the inventor of PowerShell, and Jason Helmick. This free online course is recommended for anyone wanting a deeper exploration 
                        of PowerShell.

                    </p>
                </section>
            </div>
        </article>
    </main>
    <footer>
        <p>Copyright &copy; 2021 Lukas Vasadi</p>
    </footer>
	<script src="../scripts/main.js"></script>
    <script src="../scripts/post.js"></script>
</body>
</html>